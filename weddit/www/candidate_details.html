<h1>{{doc.name }}</h1>

<div class="form-group">
		<label>First Name :</label>
		<input type="text" value="{{doc.first_name}}" class="form-control" name="first_name" id="fn">
</div>
<div class="form-group">
		<label>Last Name :</label>
		<input type="text" value="{{doc.last_name}}" class="form-control" name="last_name" id="ln">
</div>
<div class="form-group">
		<label>Date of Birth :</label>
		<input type="date" value="{{doc.date_of_birth}}" class="form-control" name="date_of_birth" id="dob">
</div>
<div class="form-group">
		<label>Mobile No :</label>
		<input type="text" value="{{doc.mobile_no}}" class="form-control" name="date_of_birth" id="mn">
</div>
<div class="form-group">
	<label for ="gn">Gender :</label>
		<select class="form-control" id="gn">	
			<option></option>
			<option>Female</option>
			<option>Male</option>

		</select>
</div>	
<div class="form-group">
		<label>Marital Status :</label>
		<input type="select" class="form-control" name="date_of_birth" id="ms">

</div>
<div class="form-group">
		<label>Religion :</label>
		<input type="select" class="form-control" name="date_of_birth" id="regn">

</div>
<div class="form-group">
		<label>Caste :</label>
		<input type="select" class="form-control" name="date_of_birth" id="caste">

</div>
<div class="form-group">
		<label>other Tongue :</label>
		<input type="select" class="form-control" name="date_of_birth" id="mt">

</div>
<div class="form-group">
		<label>City :</label>
		<input type="select" class="form-control" name="date_of_birth" id="ct">

</div>
<div id="family_members">
	<div class="row">
    	<div class="col-xs-4">First Name</div>
    	<div class="col-xs-3">Last Name</div>
    	<div class="col-xs-3">Relation</div>
    	<div class="col-xs-1"></div>
    	<div class="col-xs-1"></div>
  	</div>
	{% for fm in doc.family_members %}
		 <div class="row" id="{{fm.name}}">
    		<div class="col-xs-4" id="firstname">
    			<span id="{{ fm.name + '-fn'}}">
    				{{fm.first_name}} 
    			</span>
    			<input type="text" name="fm1" id="{{ fm.name + '-fn-edit'}}" class="hide">
    		</div>
    		<div class="col-xs-3" id="lastname">
    			<span id="{{ fm.name + '-ln'}}">
    				{{fm.last_name}}
    			</span>
    			<input type="text" name="fm2" id="{{ fm.name + '-ln-edit'}}" class="hide">
    		</div>
    		<div class="col-xs-3" id="relation">
    			<span id="{{ fm.name + '-rl'}}">
    				{{fm.relation}}
    			</span>
    			<input type="text" name="fm3" id="{{ fm.name + '-rl-edit'}}" class="hide">
    		</div>
    		<div class="col-xs-1">
    			<button data-role="update_li" data-fmid="{{fm.name}}">Edit</button>
    			<button data-role="save_li" data-fmid="{{fm.name}}">Save</button>
    		</div>
    		<div class="col-xs-1">
    			<button data-role="delete_li" data-fmid="{{fm.name}}">Delete</button>
    		</div>
  		</div>
	{% endfor %}


		<div class="row">
    		<div class="col-xs-4"><input type="text" name="first" id="addfn"></div>
    		<div class="col-xs-3"><input type="text" name="last" id="addln"></div>
    		<div class="col-xs-3"><input type="text" name="relation" id="addrel"></div>
    		<div class="col-xs-1">
    			<button id="addfm">Add</button>
    		</div>
  		</div>



</div>

		
<input type="submit" name="edit" id="edit">
<script type="text/javascript">
	frappe.ready(function(){
		$("#edit").on("click", function() {
			// fn = $("#first_name").val();
			frappe.call({
				args: {
					"docname": "{{doc.name}}",
					"firstname": $("#fn").val(),
					"lastname": $("#ln").val(),
					"dateofbirth" : $("#dob").val(),
					"mobileno" : $("#mn").val(),
					"gen" : $("#gn").val(),
					"marstat" : $("#ms").val(),
					"relgn" : $("#regn").val(),
					"cas" : $("#caste").val(),
					"mothtng" : $("#mt").val(),
					"city" : $("#ct").val(),
				},
				method: "weddit.www.candidate_details.edit_data",
				callback: function(r) {
					frappe.msgprint(r.message);
				}
			});
		});
		$("button[data-role='update_li']").on("click", function(){
			fmid = $(this).attr("data-fmid");

			inputid_fn = '#' + fmid + '-fn-edit';
			inputid_ln = '#' + fmid + '-ln-edit';
			inputid_rl = '#' + fmid + '-rl-edit';

			spanid_fn = '#' + fmid + '-fn';
			spanid_ln = '#' + fmid + '-ln';
			spanid_rl = '#' + fmid + '-rl';

			span_fn = $(spanid_fn);
			span_ln = $(spanid_ln);
			span_rl = $(spanid_rl);

			$(inputid_fn).removeClass('hide').val($.trim(span_fn.text()));
			span_fn.addClass('hide');
			$(inputid_ln).removeClass('hide').val($.trim(span_ln.text()));
			span_ln.addClass('hide');
			$(inputid_rl).removeClass('hide').val($.trim(span_rl.text()));
			span_rl.addClass('hide');
		});

		$("button[data-role='save_li']").on("click", function(){
			fmid = $(this).attr("data-fmid");

			inputid_fn = '#' + fmid + '-fn-edit';
			inputid_ln = '#' + fmid + '-ln-edit';
			inputid_rl = '#' + fmid + '-rl-edit';

			spanid_fn = '#' + fmid + '-fn';
			spanid_ln = '#' + fmid + '-ln';
			spanid_rl = '#' + fmid + '-rl';

			span_fn = $(spanid_fn);
			span_ln = $(spanid_ln);
			span_rl = $(spanid_rl);

			fn = $(inputid_fn).val();
			ln = $(inputid_ln).val();
			rl = $(inputid_rl).val();

			// $(inputid_fn).removeClass('hide').val($.trim(span_fn.text()));
			// span_fn.addClass('hide');
			// $(inputid_ln).removeClass('hide').val($.trim(span_ln.text()));
			// span_ln.addClass('hide');
			// $(inputid_rl).removeClass('hide').val($.trim(span_rl.text()));
			// span_rl.addClass('hide');


			frappe.call({
				args:{
					"fmid" : fmid,
					"firstname": fn,
					"lastname" : ln,
					"relation" : rl
				},
				method:"weddit.www.candidate_details.save_fm",
				callback: function(r) {
					frappe.msgprint(r.message);
				}
			});

		});


		$("#addfm").on("click", function(){
			fn = $("#addfn").val();
			ln = $("#addln").val();
			rl = $("#addrel").val();
			frappe.call({
				args:{
					"firstname": fn,
					"lastname" : ln,
					"relation" : rl
				},
				method:"weddit.www.candidate_details.add_fm",
				callback: function(r) {
					frappe.msgprint(r.message);
				}
			});
		});

	});

</script>





